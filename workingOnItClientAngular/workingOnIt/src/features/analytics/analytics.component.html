<div class="analytics-container">
  <h1>Analytics Dashboard</h1>

  <div class="charts-grid">
    <!-- Global Scores Chart -->
    <mat-card class="chart-card">
      <mat-card-header>
        <mat-card-title>Global User Scores</mat-card-title>
        <mat-card-subtitle>All user performance overview</mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        <canvas baseChart
                [data]="globalChartData"
                [options]="globalChartOptions"
                [type]="globalChartType">
        </canvas>
      </mat-card-content>
    </mat-card>

    <!-- User Selection and Individual Chart -->
    <mat-card class="chart-card">
      <mat-card-header>
        <mat-card-title>Individual User Performance</mat-card-title>
        <mat-card-subtitle>Select a user to view their score history</mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        <mat-form-field appearance="outline" class="user-select">
          <mat-label>Select User</mat-label>
          <mat-select [(value)]="selectedUserId" (selectionChange)="onUserSelect()">
            <mat-option *ngFor="let user of users" [value]="user.id">
              {{user.fullName}} ({{user.email}})
            </mat-option>
          </mat-select>
        </mat-form-field>

        <canvas baseChart
                [data]="userChartData"
                [options]="userChartOptions"
                [type]="userChartType"
                *ngIf="selectedUserId">
        </canvas>

        <div class="no-data" *ngIf="!selectedUserId">
          <p>Please select a user to view their performance chart</p>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Test Statistics -->
    <mat-card class="stats-card">
      <mat-card-header>
        <mat-card-title>Test Statistics</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="stats-grid">
          <div class="stat-item">
            <h3>{{totalTests}}</h3>
            <p>Total Tests</p>
          </div>
          <div class="stat-item">
            <h3>{{averageScore}}%</h3>
            <p>Average Score</p>
          </div>
          <div class="stat-item">
            <h3>{{highestScore}}%</h3>
            <p>Highest Score</p>
          </div>
          <div class="stat-item">
            <h3>{{activeUsers}}</h3>
            <p>Active Users</p>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>
